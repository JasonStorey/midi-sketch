if(MIDI===void 0)var MIDI={};if(function(){"use strict";var e={},n=0,t=function(t){n++;var o=new Audio,a=t.split(";")[0];o.id="audio",o.setAttribute("preload","auto"),o.setAttribute("audiobuffer",!0),o.addEventListener("error",function(){e[a]=!1,n--},!1),o.addEventListener("canplaythrough",function(){e[a]=!0,n--},!1),o.src="data:"+t,document.body.appendChild(o)};MIDI.audioDetect=function(o){if(navigator.requestMIDIAccess){var a=Function.prototype.toString.call(navigator.requestMIDIAccess).indexOf("[native code]");if(a)e.webmidi=!0;else for(var r=0;navigator.plugins.length>r;r++){var i=navigator.plugins[r];i.name.indexOf("Jazz-Plugin")>=0&&(e.webmidi=!0)}}if("undefined"==typeof Audio)return o({});e.audiotag=!0,(window.AudioContext||window.webkitAudioContext)&&(e.webaudio=!0);var u=new Audio;if(u.canPlayType===void 0)return o(e);var l=u.canPlayType('audio/ogg; codecs="vorbis"');l="probably"===l||"maybe"===l;var c=u.canPlayType("audio/mpeg");if(c="probably"===c||"maybe"===c,!l&&!c)return o(e),void 0;l&&t("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),c&&t("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var s=(new Date).getTime(),d=window.setInterval(function(){var t=(new Date).getTime(),a=t-s>5e3;(!n||a)&&(window.clearInterval(d),o(e))},1)}}(),MIDI===void 0)var MIDI={};if(MIDI.Soundfont===void 0&&(MIDI.Soundfont={}),function(e){"use strict";window.AudioContext=window.AudioContext||window.webkitAudioContext,e.DEBUG=!1,e.USE_XHR=!0,e.soundfontUrl="./soundfont/",e.loadPlugin=function(o){"function"==typeof o&&(o={callback:o}),e.soundfontUrl=o.soundfontUrl||e.soundfontUrl,e.audioDetect(function(a){var r=window.location.hash,i="";if(i=a[o.api]?o.api:a[r.substr(1)]?r.substr(1):a.webmidi?"webmidi":window.AudioContext?"webaudio":window.Audio?"audiotag":"flash",t[i]){if(o.targetFormat)var u=o.targetFormat;else var u=a["audio/ogg"]?"ogg":"mp3";e.lang=i,e.supports=a;var l=n(o);t[i](u,l,o)}})};var n=function(n){var t=n.instruments||n.instrument;"object"!=typeof t&&(t=t?[t]:[]);for(var o=0;t.length>o;o++){var a=t[o];"number"==typeof a&&(t[o]=e.GeneralMIDI.byId[a])}return t},t={};t.webmidi=function(n,t,o){e.loader&&e.loader.message("Web MIDI API..."),e.WebMIDI.connect(o)},t.flash=function(n,t,o){e.loader&&e.loader.message("Flash API..."),dom.loadScript.add({url:o.soundManagerUrl||"./inc/SoundManager2/script/soundmanager2.js",verify:"SoundManager",callback:function(){e.Flash.connect(t,o)}})},t.audiotag=function(n,t,a){e.loader&&e.loader.message("HTML5 Audio API..."),new Queue({items:t,progress:function(n){e.loader&&t.length&&e.loader.update(null,"Downloading...",100*n>>0)},next:function(e){o(this,e,n)},callback:function(){e.AudioTag.connect(a)}})},t.webaudio=function(n,t,a){e.loader&&e.loader.message("Web Audio API..."),new Queue({items:t,progress:function(n){e.loader&&t.length&&e.loader.update(null,"Downloading...",100*n>>0)},next:function(e){o(this,e,n)},callback:function(){e.WebAudio.connect(a)}})};var o=function(n,t,o){var i=e.soundfontUrl+t+"-"+o+".js";MIDI.Soundfont[t]?n.next():e.USE_XHR?dom.request({url:i,onprogress:r,onload:function(e){a({text:e.responseText}),n.next()}}):dom.loadScript.add({url:i,verify:"MIDI.Soundfont['"+t+"']",callback:function(){console.log(MIDI.Soundfont),n.next()}})},a=function(e){var n=document.createElement("script");n.language="javascript",n.type="text/javascript",e.text&&(n.text=e.text),e.src&&(n.src=e.src),document.body.appendChild(n)},r=function(n){this.totalSize||(this.totalSize=this.getResponseHeader("Content-Length-Raw")?parseInt(this.getResponseHeader("Content-Length-Raw")):n.total);var t=this.totalSize?Math.round(100*(n.loaded/this.totalSize)):"";e.loader&&e.loader.update(null,"Downloading...",t)}}(MIDI),function(){"use strict";var e=function(e){for(var n in e)MIDI[n]=e[n]};(function(){var n=null,t=null,o=MIDI.WebMIDI={api:"webmidi"};o.send=function(e,n){t.send(e,1e3*n)},o.setController=function(e,n,o,a){t.send([e,n,o],1e3*a)},o.setVolume=function(e,n,o){t.send([176+e,7,n],1e3*o)},o.programChange=function(e,n,o){t.send([192+e,n],1e3*o)},o.pitchBend=function(e,n,o){t.send([224+e,n],1e3*o)},o.noteOn=function(e,n,o,a){t.send([144+e,n,o],1e3*a)},o.noteOff=function(e,n,o){t.send([128+e,n,0],1e3*o)},o.chordOn=function(e,n,o,a){for(var r=0;n.length>r;r++){var i=n[r];t.send([144+e,i,o],1e3*a)}},o.chordOff=function(e,n,o){for(var a=0;n.length>a;a++){var r=n[a];t.send([128+e,r,0],1e3*o)}},o.stopAllNotes=function(){t.cancel();for(var e=0;16>e;e++)t.send([176+e,123,0])},o.connect=function(a){e(o),navigator.requestMIDIAccess().then(function(e){n=e,t=n.outputs()[0],MIDI.loader&&MIDI.loader.stop(),a.callback&&a.callback()},function(){a.api=window.AudioContext?"webaudio":window.Audio?"audiotag":"flash",MIDI.loadPlugin(a)})}})(),window.AudioContext&&function(){var n=function(e,n,t){if(o){var a=new Audio;a.src=e,a.controls=!1,a.autoplay=!1,a.preload=!1,a.addEventListener("canplay",function(){callback(a)}),a.addEventListener("error",function(e){console.log(e)}),document.body.appendChild(a)}else if(0===e.indexOf("data:audio")){var r=e.split(",")[1],i=Base64Binary.decodeArrayBuffer(r),u=MIDI.Player.ctx;u.decodeAudioData(i,n,t)}else{var l=new XMLHttpRequest;l.open("GET",e,!0),l.responseType="arraybuffer",l.onload=function(){var e=MIDI.Player.ctx;e.decodeAudioData(l.response,n,t)},l.send()}};new AudioContext;var t,o=!1,a=MIDI.WebAudio={api:"webaudio"},r={},i=127,u={},l=function(e,t,o,a,r,i){var l=MIDI.Soundfont[t];if(l.isLoaded)return i(t);var c=MIDI.GM.byName[t],s=c.number,d=o[a],f=MIDI.Soundfont[t][d];if(!f)return i(t);var A=function(e){console.log(e)},I=function(e){for(var n=d;3>n.length;)n+="&nbsp;";if(MIDI.loader!==void 0&&MIDI.loader.update(null,c.instrument+"<br>Processing: "+(100*(a/87)>>0)+"%<br>"+n),e.id=d,r[a]=e,r.length===o.length){for(;r.length;)if(e=r.pop()){var f=MIDI.keyToNote[e.id];u[s+""+f]=e}l.isLoaded=!0,i(t)}},m=l[d];n(m,I,A)};a.send=function(){},a.setController=function(){},a.setVolume=function(e,n,t){setTimeout(function(){i=n},t||0)},a.programChange=function(e,n,t){setTimeout(function(){var t=MIDI.channels[e];t.instrument=n},t||0)},a.pitchBend=function(e,n,t){setTimeout(function(){var t=MIDI.channels[e];t.pitchBend=n},t||0)},a.noteOn=function(e,n,l,c){var s=MIDI.getChannel(e),d=s.instrument,f=d+""+n,A=u[f];if(!A)return MIDI.DEBUG&&console.log("missing instrument",d,MIDI.GM.byId[d]),void 0;if(t.currentTime>c&&(c+=t.currentTime),o)var I=t.createMediaElementSource(A);else{var I=t.createBufferSource();I.buffer=A}a.ff&&I.connect(a.ff.input),r[e+""+n]=I,I.connect(t.destination),I.gainNode=t.createGain();var m=2*l/127*(i/127)-1;return I.gainNode.connect(t.destination),I.gainNode.gain.value=Math.min(1,Math.max(-1,m)),I.connect(I.gainNode),o?setTimeout(function(){A.currentTime=0,A.play()},1e3*(c||0)):I.noteOn?I.noteOn(c||0):I.start(c||0),I},a.noteOff=function(e,n,a){var i=MIDI.getChannel(e);if(i){var l=i.instrument,c=l+""+n,s=u[c];if(s){a=a||0,t.currentTime>a&&(a+=t.currentTime);var d=r[e+""+n];if(d){if(d.gainNode){var f=d.gainNode.gain;f.linearRampToValueAtTime(f.value,a),f.linearRampToValueAtTime(-1,a+.4)}o?setTimeout(function(){s.pause()},1e3*a):d.noteOff?d.noteOff(a+.5):d.stop(a+.5),delete r[e+""+n]}}}},a.chordOn=function(e,n,t,o){for(var r,i={},u=0,l=n.length;l>u;u++)i[r=n[u]]=a.noteOn(e,r,t,o);return i},a.chordOff=function(e,n,t){for(var o,r={},i=0,u=n.length;u>i;i++)r[o=n[i]]=a.noteOff(e,o,t);return r},a.stopAllNotes=function(){for(var e in r){var n=0;t.currentTime>n&&(n+=t.currentTime),r[e].gain.linearRampToValueAtTime(1,n),r[e].gain.linearRampToValueAtTime(0,n+.2),r[e].noteOff(n+.3),delete r[e]}},a.connect=function(n){e(a),null==MIDI.Player.ctx?MIDI.Player.ctx=t=new AudioContext:t=MIDI.Player.ctx,t.createScriptProcessor||(t.createScriptProcessor=t.createJavaScriptNode),t.createDelay||(t.createDelay=t.createDelayNode),t.createGain||(t.createGain=t.createGainNode);var o=[],r=MIDI.keyToNote;for(var i in r)o.push(i);var u=[],c={},s=function(e){delete c[e];for(var t in c)break;t||(MIDI.loader&&MIDI.loader.stop(),n.callback&&n.callback())};for(var d in MIDI.Soundfont){c[d]=!0;for(var f=0;o.length>f;f++)l(t,d,o,f,u,s)}u.length||s()}}(),window.Audio&&function(){for(var n=MIDI.AudioTag={api:"audiotag"},t={},o=127,a=-1,r=[],i=[],u={},l=0;12>l;l++)r[l]=new Audio;var c=function(e,n){if(MIDI.channels[e]){var t=MIDI.channels[e].instrument,l=MIDI.GM.byId[t].id,n=u[n];if(n){var c=l+""+n.id,s=(a+1)%r.length,d=r[s];if(i[s]=c,!MIDI.Soundfont[l])return MIDI.DEBUG&&console.log(l),void 0;d.src=MIDI.Soundfont[l][n.id],d.volume=o/127,d.play(),a=s}}},s=function(e,n){if(MIDI.channels[e]){var t=MIDI.channels[e].instrument,o=MIDI.GM.byId[t].id,n=u[n];if(n)for(var l=o+""+n.id,c=0;r.length>c;c++){var s=(c+a+1)%r.length,d=i[s];if(d&&d==l)return r[s].pause(),i[s]=null,void 0}}};n.send=function(){},n.setController=function(){},n.setVolume=function(e,n){o=n},n.programChange=function(e,n){MIDI.channels[e].instrument=n},n.pitchBend=function(){},n.noteOn=function(e,n,o,a){var r=t[n];if(u[r])return a?setTimeout(function(){c(e,r)},1e3*a):(c(e,r),void 0)},n.noteOff=function(){},n.chordOn=function(e,n,o,a){for(var r=0;n.length>r;r++){var i=n[r],l=t[i];if(u[l]){if(a)return setTimeout(function(){c(e,l)},1e3*a);c(e,l)}}},n.chordOff=function(e,n,o){for(var a=0;n.length>a;a++){var r=n[a],i=t[r];if(u[i]){if(o)return setTimeout(function(){s(e,i)},1e3*o);s(e,i)}}},n.stopAllNotes=function(){for(var e=0,n=r.length;n>e;e++)r[e].pause()},n.connect=function(o){for(var a in MIDI.keyToNote)t[MIDI.keyToNote[a]]=a,u[a]={id:a};e(n),MIDI.loader&&MIDI.loader.stop(),o.callback&&o.callback()}}(),function(){var n=MIDI.Flash={api:"flash"},t={},o={};n.send=function(){},n.setController=function(){},n.setVolume=function(){},n.programChange=function(e,n){MIDI.channels[e].instrument=n},n.pitchBend=function(){},n.noteOn=function(e,n,a,r){if(MIDI.channels[e]){var i=MIDI.channels[e].instrument,u=MIDI.GM.byId[i].number;if(n=u+""+t[n],o[n])return r?setTimeout(function(){o[n].play({volume:2*a})},1e3*r):(o[n].play({volume:2*a}),void 0)}},n.noteOff=function(){},n.chordOn=function(e,n,a){if(MIDI.channels[e]){var r=MIDI.channels[e].instrument,i=MIDI.GM.byId[r].number;for(var u in n){var l=n[u],c=i+""+t[l];o[c]&&o[c].play({volume:2*a})}}},n.chordOff=function(){},n.stopAllNotes=function(){},n.connect=function(a,r){soundManager.flashVersion=9,soundManager.useHTML5Audio=!0,soundManager.url=r.soundManagerSwfUrl||"../inc/SoundManager2/swf/",soundManager.useHighPerformance=!0,soundManager.wmode="transparent",soundManager.flashPollingInterval=1,soundManager.debugMode=!1,soundManager.onload=function(){for(var i=function(e,n,t){var a=MIDI.GM.byName[e],r=a.number;o[r+""+n]=soundManager.createSound({id:n,url:MIDI.soundfontUrl+e+"-mp3/"+n+".mp3",multiShot:!0,autoLoad:!0,onload:t})},u=[],l=88,c=a.length*l,s=0;a.length>s;s++)for(var d=a[s],f=function(){u.push(this.sID),void 0!==MIDI.loader&&MIDI.loader.update(null,"Processing: "+this.sID)},A=0;l>A;A++){var I=t[A+21];i(d,I,f)}e(n);var m=setInterval(function(){c>u.length||(clearInterval(m),MIDI.loader&&MIDI.loader.stop(),r.callback&&r.callback())},25)},soundManager.onerror=function(){};for(var i in MIDI.keyToNote)t[MIDI.keyToNote[i]]=i}}(),MIDI.GM=function(e){var n=function(e){return e.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},t={byName:{},byId:{},byCategory:{}};for(var o in e)for(var a=e[o],r=0,i=a.length;i>r;r++){var u=a[r];if(u){var l=parseInt(u.substr(0,u.indexOf(" ")),10);u=u.replace(l+" ",""),t.byId[--l]=t.byName[n(u)]=t.byCategory[n(o)]={id:n(u),instrument:u,number:l,category:o}}}return t}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"]}),MIDI.getChannel=function(e){return MIDI.channels[e]},MIDI.getInstrument=function(e){var n=MIDI.getChannel(e);return n&&n.instrument},MIDI.getMono=function(e){var e=MIDI.getChannel(ch);return e&&e.mono},MIDI.getOmni=function(e){var e=MIDI.getChannel(ch);return e&&e.omni},MIDI.getSolo=function(e){var e=MIDI.getChannel(ch);return e&&e.solo},MIDI.channels=function(){for(var e={},n=0;16>n;n++)e[n]={instrument:n,pitchBend:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}(),MIDI.pianoKeyOffset=21,MIDI.keyToNote={},MIDI.noteToKey={},function(){for(var e=21,n=108,t=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],o=e;n>=o;o++){var a=(o-12)/12>>0,r=t[o%12]+a;MIDI.keyToNote[r]=o,MIDI.noteToKey[o]=r}}()}(),MIDI===void 0)var MIDI={};MIDI.Player===void 0&&(MIDI.Player={}),function(){"use strict";var e=MIDI.Player;e.callback=void 0,e.currentTime=0,e.endTime=0,e.restart=0,e.playing=!1,e.timeWarp=1,e.startDelay=0,e.start=e.resume=function(n){-1>e.currentTime&&(e.currentTime=-1),d(e.currentTime,null,n)},e.pause=function(){var n=e.restart;f(),e.restart=n},e.stop=function(){f(),e.restart=0,e.currentTime=0},e.addListener=function(e){i=e},e.removeListener=function(){i=void 0},e.clearAnimation=function(){e.interval&&window.clearInterval(e.interval)},e.setAnimation=function(n){var t="function"==typeof n?n:n.callback,o=n.interval||30,a=0,i=0,u=0;e.clearAnimation(),e.interval=setInterval(function(){if(0!==e.endTime){e.playing?(a=u===e.currentTime?i-(new Date).getTime():0,a=0===e.currentTime?0:e.currentTime-a,u!==e.currentTime&&(i=(new Date).getTime(),u=e.currentTime)):a=e.currentTime;var n=e.endTime,o=a/1e3,l=o/60,c=o-60*l,s=60*l+c,d=n/1e3;-1>d-s||t({now:s,end:d,events:r})}},o)},e.loadMidiFile=function(n){e.replayer=new Replayer(MidiFile(e.currentData),e.timeWarp,null,MIDI.BPM),e.data=e.replayer.getData(),e.endTime=c(),MIDI.loadPlugin({instruments:e.getFileInstruments(),callback:n})},e.loadFile=function(n,t){if(e.stop(),-1!==n.indexOf("base64,")){var o=window.atob(n.split(",")[1]);return e.currentData=o,e.loadMidiFile(t),void 0}var a=new XMLHttpRequest;a.open("GET",n),a.overrideMimeType("text/plain; charset=x-user-defined"),a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){for(var n=this.responseText||"",o=[],a=n.length,r=String.fromCharCode,i=0;a>i;i++)o[i]=r(255&n.charCodeAt(i));var u=o.join("");e.currentData=u,e.loadMidiFile(t)}},a.send()},e.getFileInstruments=function(){for(var n={},t={},o=0;e.data.length>o;o++){var a=e.data[o][0].event;if("channel"===a.type){var r=a.channel;switch(a.subtype){case"controller":break;case"programChange":t[r]=a.programNumber;break;case"noteOn":var i=t[r],u=MIDI.GM.byId[isFinite(i)?i:r];n[u.id]=!0}}}var l=[];for(var c in n)l.push(c);return l};var n,t,o=[],a=0,r={},i=void 0,u=function(t,a,u,l,c,s){return setTimeout(function(){var l={channel:t,note:a,now:u,end:e.endTime,message:c,velocity:s};128===c?delete r[a]:r[a]=l,i&&i(l),e.currentTime=u,o.shift(),1e3>o.length?d(n,!0):e.currentTime===n&&e.endTime>n&&d(n,!0)},u-l)},l=function(){return"WebAudioAPI"===MIDI.lang?MIDI.Player.ctx:(e.ctx||(e.ctx={currentTime:0}),e.ctx)},c=function(){for(var n=e.data,t=n.length,o=.5,a=0;t>a;a++)o+=n[a][1];return o},s=function(){return window.performance&&window.performance.now?window.performance.now():Date.now()},d=function(r,i,d){if(e.replayer){i||(r===void 0&&(r=e.restart),e.playing&&f(),e.playing=!0,e.data=e.replayer.getData(),e.endTime=c());var A,I=0,m=0,p=e.data,g=l(),v=p.length;n=.5,o[0]&&o[0].interval||0;var h=r-e.currentTime;if("webaudio"!==MIDI.api){var q=s();t=t||q,g.currentTime=(q-t)/1e3}a=g.currentTime;for(var M=0;v>M&&100>m;M++){var D=p[M][1];if(r>=(n+=D))I=n;else{r=n-I;var y=p[M][0].event;if("channel"===y.type){var S=y.channel,b=MIDI.channels[S],w=g.currentTime+(r+h+e.startDelay)/1e3,T=n-I+e.startDelay;switch(y.subtype){case"controller":MIDI.setController(S,y.controllerType,y.value,w);break;case"programChange":MIDI.programChange(S,y.programNumber,w);break;case"pitchBend":MIDI.pitchBend(S,y.value,w);break;case"noteOn":if(b.mute)break;A=y.noteNumber-(e.MIDIOffset||0);var k={event:y,time:T,source:MIDI.noteOn(S,y.noteNumber,y.velocity,w),interval:u(S,A,n+e.startDelay,I-h,144,y.velocity)};o.push(k),m++;break;case"noteOff":if(b.mute)break;A=y.noteNumber-(e.MIDIOffset||0);var k={event:y,time:T,source:MIDI.noteOff(S,y.noteNumber,w),interval:u(S,A,n,I-h,128,0)};o.push(k);break;default:}}}}d&&d(o)}},f=function(){var n=l();for(e.playing=!1,e.restart+=1e3*(n.currentTime-a);o.length;){var t=o.pop();window.clearInterval(t.interval),t.source&&("number"==typeof t.source?window.clearTimeout(t.source):t.source.disconnect(0))}for(var u in r){var t=r[u];144===r[u].message&&i&&i({channel:t.channel,note:t.note,now:t.now,end:t.end,message:128,velocity:t.velocity})}r={}}}();